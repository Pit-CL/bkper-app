<!DOCTYPE html>
<html lang="en">
<head>
    <style> .navbar-brand img {max-height: 80px}</style>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                     
                        <img src="https://bkper.com/images/bkper-logo.png" alt="logo">
                    
                     
                        <h1 class="navbar-item">Google Apps Script library</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                 
                <div class="navbar-menu">
                    <div class="navbar-end">
                    
                        <div class="navbar-item">
                            <a href="https://bkper.com" target="_blank">Bkper</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://help.bkper.com" target="_blank">Help Center</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://script.google.com/home" target="_blank">Dashboard</a>
                        </div>
                    
                    </div>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="BalancesDataTableBuilder.html">BalancesDataTableBuilder</a></li><li><a href="Book.html">Book</a></li><li><a href="Group.html">Group</a></li><li><a href="Report.AccountBalanceReport.html">AccountBalanceReport</a></li><li><a href="Report.BalanceReport.html">BalanceReport</a></li><li><a href="Report.GroupBalanceReport.html">GroupBalanceReport</a></li><li><a href="Report.TagBalanceReport.html">TagBalanceReport</a></li><li><a href="Transaction.html">Transaction</a></li><li><a href="TransactionIterator.html">TransactionIterator</a></li><li><a href="TransactionsDataTableBuilder.html">TransactionsDataTableBuilder</a></li></ul><h3>Global</h3><ul><li><a href="global.html#BalanceType">BalanceType</a></li><li><a href="global.html#DecimalSeparator">DecimalSeparator</a></li><li><a href="global.html#getAuthorizationHtml">getAuthorizationHtml</a></li><li><a href="global.html#isUserAuthorized">isUserAuthorized</a></li><li><a href="global.html#listBooks">listBooks</a></li><li><a href="global.html#listLedgers">listLedgers</a></li><li><a href="global.html#openById">openById</a></li><li><a href="global.html#openLedgerById">openLedgerById</a></li><li><a href="global.html#Periodicity">Periodicity</a></li><li><a href="global.html#Permission">Permission</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Title</p>
                        <h1>Home</h1>
                    </header>
                    
                    



    


    <h3> </h3>










    




    <section>
        <article><h2>BkperApp  <a href="https://script.google.com/macros/s/AKfycbyWJJFIwoqnNudRMGse18qVNWw5aa7g03-iLmL_rjqO8mg-MjI/exec?suite=BkperApp&amp;namespace=bkper"><img src="https://gs-tests-status.appspot.com/badge.svg?suite=BkperApp&amp;namespace=bkper" alt="GSTests status"></a></h2>
<p>BkperApp is a <a href="https://developers.google.com/apps-script/reference/">Google Apps Script</a> library for Bkper.</p>
<p>With BkperApp you can create many solutions on G Suite, such as the <a href="https://gsuite.google.com/marketplace/app/bkper_sheets/75894855272">Sheets</a> and <a href="https://gsuite.google.com/marketplace/app/bkper_forms/588203895124">Forms</a> Add-ons, simple automations or advanced solutions with <a href="https://developers.google.com/apps-script/api/concepts/">Google Apps Script API</a>, and you can manage your scripts in the <a href="https://script.google.com/home">Dashboard</a>.</p>
<p>It works the same way your favorite Google Apps Script library works, like <a href="https://developers.google.com/apps-script/reference/calendar/calendar-app">CalendarApp</a>, <a href="https://developers.google.com/apps-script/reference/document/document-app">DocumentApp</a>, <a href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app">SpreadsheetApp</a> etc, and it is safely authorized using <a href="http://oauth.net/">OAuth2</a> protocol:</p>
<p><img src="http://developers.bkper.com/images/docs/BkperApp-overview.png" alt="BkperApp overview"></p>
<h3>Authorization</h3>
<p>To authorize the library, you just need to run the OAuth2 flow only once per account. This can be easily done when you install any Add-ons, or by clicking and running this <a href="https://script.google.com/macros/s/AKfycbz8F5FGTTW72pQBfDvGjEB4eglVmOfhG_a9Qb3EXYjVo5IICg/exec">authorization script</a></p>
<h3>Setup</h3>
<p>This library is already published as an Apps Script, making it easy to include in your project. To add it to your script, do the following in the Apps Script code editor:</p>
<ol>
<li>Click on the menu item &quot;Resources &gt; Libraries...&quot;</li>
<li>In the &quot;Find a Library&quot; text box, enter the project key &quot;<strong>My8jgp9C1MEeWVxuYNppyFgoOxUd2qb-3</strong>&quot; and click the &quot;Select&quot; button.</li>
<li>Choose a version in the dropdown box (usually best to pick the latest version).</li>
<li>Click the &quot;Save&quot; button.</li>
</ol>
<h3>Record Transactions</h3>
<p>To record your first <a href="http://developers.bkper.com/docs/BkperApp/Transaction.html">Transaction</a>, after authorizing and setup, copy and paste the function bellow:</p>
<pre class="prettyprint source lang-javascript"><code>function recordATransaction() {

  var book = BkperApp.openById(&quot;agtzfmJrcGVyLWhyZHIOCxIGTGVkZ2VyGNKJAgw&quot;);

  book.record(&quot;#gas 63.23&quot;);

}
</code></pre>
<p>Exchange the parameter of the function <a href="http://developers.bkper.com/docs/BkperApp/global.html#openById">openById</a> for the id of the <a href="http://developers.bkper.com/docs/BkperApp/Book.html">Book</a> you want to record the <a href="http://developers.bkper.com/docs/BkperApp/Transaction.html">Transaction</a>. This is the same parameter found on the URL accessed on <a href="https://www.bkper.com">bkper.com</a>:</p>
<p><img src="http://developers.bkper.com/images/docs/bookId.png" alt="bookId"></p>
<p>Now run the <strong>recordATransaction</strong> function and see the record appearing on the bkper screen:</p>
<p><img src="http://developers.bkper.com/images/docs/recording.png" alt="Recording"></p>
<p>You can also record transactions in batch by passing an Array of strings as the <a href="http://developers.bkper.com/docs/BkperApp/Book.html#record">record</a> method parameter:</p>
<pre class="prettyprint source lang-javascript"><code>function batchRecordTransactions() {

  var book = BkperApp.openById(&quot;agtzfmJrcGVyLWhyZHIOCxIGTGVkZ2VyGNKJAgw&quot;);

  var transactions = new Array();

  transactions.push(&quot;#breakfast 15.40&quot;);
  transactions.push(&quot;#lunch 27.45&quot;);
  transactions.push(&quot;#dinner 35.86&quot;);

  book.record(transactions);

}
</code></pre>
<p>The above code will send all records in a bulk. Very useful for importing large amount of data without the risk of reaching script limits.</p>
<h3>Query Transactions</h3>
<p>Each book is a large database and every interaction is done in terms of queries. Everytime you &quot;select&quot; an <a href="http://developers.bkper.com/docs/BkperApp/Account.html">Account</a> by clicking on left menu at <a href="https://www.bkper.com">bkper.com</a>, you are actually filtering transactions by that <a href="http://developers.bkper.com/docs/BkperApp/Account.html">Account</a>.</p>
<p>Every query is shown in the search box on top of the page:</p>
<p><img src="http://developers.bkper.com/images/docs/query.png" alt="Query"></p>
<p>When you search transactions, the <a href="http://developers.bkper.com/docs/BkperApp/Book.html#search">search</a> method returns an <a href="http://developers.bkper.com/docs/BkperApp/TransactionIterator.html">TransactionIterator</a> to let you handle potentially large datasets:</p>
<pre class="prettyprint source lang-javascript"><code>function queryTransactions() {

  var book = BkperApp.openById(&quot;agtzfmJrcGVyLWhyZHITCxIGTGVkZ2VyGICAgKCtg6MLDA&quot;);

  //Search returns an interator to deal with potencial large datasets
  var transactionIterator = book.search(&quot;acc:'Bank' after:01/04/2014&quot;);

  while (transactionIterator.hasNext()) {
    var transaction = transactionIterator.next();
    Logger.log(transaction.getDescription());
  }

}
</code></pre>
<p>Run the <strong>queryTransactions</strong> function, exchanging your bookId, with the same query, check the log output and you will see the same descriptions:</p>
<p><img src="http://developers.bkper.com/images/docs/logSearch.png" alt="Search log"></p>
<h3>List Accounts Balances</h3>
<p>You can access all Account objects, and query its balances, in a way similar to the left sidebar:</p>
<pre class="prettyprint source lang-javascript"><code>function listAccountBalances() {
  //Open the book
  var book = BkperApp.openById(&quot;agtzfmJrcGVyLWhyZHIOCxIGTGVkZ2VyGNKJAgw&quot;);

  var accounts = book.getAccounts();
  for (var i=0; i &lt; accounts.length; i++) {
    var account = accounts[i];
    if (account.isPermanent() && account.isActive()) {
      Logger.log(account.getName() + &quot;: &quot; + account.getBalance());
    }
  }
}
</code></pre>
<h3>Query Balances over time</h3>
<p>it is very easy to query balances of Accounts and #hashtags over time, getting period and cumulative balances. Balance queries are used in <a href="https://www.bkper.com">bkper.com</a> to generate chart reports:</p>
<p><img src="http://developers.bkper.com/images/docs/balanceQueries.png" alt="Balance Queries"></p>
<p>You can easily run balance queries on your script, by calling the function <a href="http://developers.bkper.com/docs/BkperApp/Book.html#getBalanceReport">getBalanceReport</a>, like the example bellow:</p>
<pre class="prettyprint source lang-javascript"><code>/**
Deploy as web app to get the generated Charts
*/
function doGet() {

  //Open the book
  var book = BkperApp.openById(&quot;agtzfmJrcGVyLWhyZHITCxIGTGVkZ2VyGICAgKCtg6MLDA&quot;);

  //Query for balances
  var report = book.getBalanceReport(&quot;= group:'Expenses' group:'Incomes' after:01/2014 before:02/2014&quot;);

  //Create data table builder
  var dataTableBuilder = report.createDataTable().setBalanceType(BkperApp.BalanceType.TOTAL);

  //Create chart
  var chartsDataTable = dataTableBuilder.buildChartDataTable();
  var pieChart = Charts.newPieChart().setDataTable(chartsDataTable).build();
  var tableChart = Charts.newTableChart().setDataTable(chartsDataTable).build();

  //Add to UI
  var ui = UiApp.createApplication();
  ui.add(pieChart);
  ui.add(tableChart);

  return ui;

}
</code></pre>
<p>Exchange the book id and the query, deploy and run the <a href="https://developers.google.com/apps-script/execution_web_apps">script as a web app</a>, and you will get a report like this <a href="https://script.google.com/macros/s/AKfycbxm2ezSE16D2pcuc3Hr-R8gFEZ7q_i8r55WHCsaFcH4ugwZ2cM/exec">live example</a>.</p>
<h3>Samples</h3>
<ul>
<li>
<p><a href="https://github.com/bkper/BkperCSVExportService">BkperCSVExportService</a> - Service to export bkper transactions in CSV format.</p>
</li>
<li>
<p><a href="https://github.com/oshliaer/bkper/tree/master/bkper%20things">bkper things</a> - Custom action scripts triggered from inside bkper through webhooks</p>
</li>
<li>
<p><a href="https://github.com/bkper/IntercomBkperBridge">IntercomBkperBridge</a> - Bridge from <a href="https://www.intercom.io/">Intercom</a> to <a href="http://about.bkper.com/">bkper</a>, to keep a view of user segments over time.</p>
</li>
</ul></article>
    </section>






                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Tue Aug 13 2019 12:03:50 GMT-0300 (Brasilia Standard Time)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers</a>
        </p>
    </div>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>