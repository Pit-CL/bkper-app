

<!DOCTYPE html>
<html lang="en">
<head>
    <style> .navbar-brand img {max-height: 80px}</style>
    <meta charset="utf-8">
    <title>JSDoc: Transaction.js</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                     
                        <img src="https://bkper.com/images/bkper-logo.png" alt="logo">
                    
                     
                        <h1 class="navbar-item">Google Apps Script library</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                 
                <div class="navbar-menu">
                    <div class="navbar-end">
                    
                        <div class="navbar-item">
                            <a href="https://bkper.com" target="_blank">Bkper</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://help.bkper.com" target="_blank">Help Center</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://script.google.com/home" target="_blank">Dashboard</a>
                        </div>
                    
                    </div>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="BalancesDataTableBuilder.html">BalancesDataTableBuilder</a></li><li><a href="Book.html">Book</a></li><li><a href="Group.html">Group</a></li><li><a href="Report.AccountBalanceReport.html">AccountBalanceReport</a></li><li><a href="Report.BalanceReport.html">BalanceReport</a></li><li><a href="Report.GroupBalanceReport.html">GroupBalanceReport</a></li><li><a href="Report.TagBalanceReport.html">TagBalanceReport</a></li><li><a href="Transaction.html">Transaction</a></li><li><a href="TransactionIterator.html">TransactionIterator</a></li><li><a href="TransactionsDataTableBuilder.html">TransactionsDataTableBuilder</a></li></ul><h3>Global</h3><ul><li><a href="global.html#BalanceType">BalanceType</a></li><li><a href="global.html#DecimalSeparator">DecimalSeparator</a></li><li><a href="global.html#getAuthorizationHtml">getAuthorizationHtml</a></li><li><a href="global.html#isUserAuthorized">isUserAuthorized</a></li><li><a href="global.html#listBooks">listBooks</a></li><li><a href="global.html#listLedgers">listLedgers</a></li><li><a href="global.html#openById">openById</a></li><li><a href="global.html#openLedgerById">openLedgerById</a></li><li><a href="global.html#Periodicity">Periodicity</a></li><li><a href="global.html#Permission">Permission</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Source</p>
                        <h1>Transaction.js</h1>
                    </header>
                    
                    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**

@classdesc
This class defines a Transaction between {@link http://en.wikipedia.org/wiki/Debits_and_credits|credit and debit} {@link Account|Accounts}.
&lt;br/>
&lt;br/>
A Transaction is the main entity on the {@link http://en.wikipedia.org/wiki/Double-entry_bookkeeping_system|Double Entry} {@link http://en.wikipedia.org/wiki/Bookkeeping|Bookkeeping} system.
&lt;br/>
Transactions are also used for {@link http://en.wikipedia.org/wiki/Single-entry_bookkeeping_system|Single Entry process} when using {@link http://en.wikipedia.org/wiki/Hashtag|#hashtags} in its {@link Transaction#setDescription|description}.
@constructor

*/
function Transaction() {

  /**
  @returns {string} The id of this Transaction
  */
  Transaction.prototype.getId = function() {
    return this.wrapped.id;
  }

  /**
  @returns {boolean} True if transaction is already posted. False otherwise.
  */
  Transaction.prototype.isPosted = function() {
    return this.wrapped.posted;
  }

  /**
  @returns {Array&lt;String>} All #hashtags used on this transaction
  */
  Transaction.prototype.getTags = function() {
    return this.wrapped.tags;
  }
  
  /**
  @returns {Array&lt;String>} All urls used on this transaction
  */
  Transaction.prototype.getUrls = function() {
    return this.wrapped.urls;
  }  

  /**
  @param {string} tag The #hashtag to check
  @returns {boolean} true if has this tag
  */
  Transaction.prototype.hasTag = function(tag) {

    var tags = this.getTags();

    for (var i = 0; i &lt; tags.length; i++) {
      if (tags[i] == tag) {
        return true;
      }
    }

    return false;
  }





  //ORIGIN ACCOUNT
  /**
  @returns {Account} The credit account. The same as origin account.
  */
  Transaction.prototype.getCreditAccount = function() {
    return this.creditAccount;
  }

  /**
  @returns {string} The credit account name.
  */
  Transaction.prototype.getCreditAccountName = function() {
    if (this.getCreditAccount() != null) {
      return this.getCreditAccount().getName();
    } else{
      return "";
    }
  }



  //DESTINATION ACCOUNT
  /**
  @returns {Account} The debit account. The same as destination account.
  */
  Transaction.prototype.getDebitAccount = function() {
    return this.debitAccount;
  }

  /**
  @returns {string} The debit account name.
  */
  Transaction.prototype.getDebitAccountName = function() {
    if (this.getDebitAccount() != null) {
      return this.getDebitAccount().getName();
    } else{
      return "";
    }
  }


  //AMOUNT
  /**
  @param {boolean} format Formats the amount according to {@link Book#getDecimalSeparator|decimal separator of book}
  @returns {number} The amount of this transaction
  */
  Transaction.prototype.getAmount = function(format) {
    if (format) {
      return this.book.formatValue(this.wrapped.amount);
    }
    return this.wrapped.amount;
  }

  /**
  @param {Account|string} account The account object, id or name
  @returns {number} The absolute amount of this transaction if the given account is at the credit side, else null
  */
  Transaction.prototype.getCreditAmount = function(account) {
    account = this.getAccount_(account);
    if (this.isCreditOnTransaction_(account)) {
      return this.getAmount();
    }
    return null;
  }

  /**
  @param {Account|string} account The account object, id or name
  @returns {number} The absolute amount of this transaction if the given account is at the debit side, else null
  */
  Transaction.prototype.getDebitAmount = function(account) {
    account = this.getAccount_(account);
    if (this.isDebitOnTransaction_(account)) {
      return this.getAmount();
    }
    return null;
  }

  /**
  @param {Account|string} account The account object, id or name
  @returns {Account} The account at the other side of the transaction given one side.
  */
  Transaction.prototype.getOtherAccount = function(account) {
    account = this.getAccount_(account);
    if (this.isCreditOnTransaction_(account)) {
      return this.getDebitAccount();
    }
    if (this.isDebitOnTransaction_(account)) {
      return this.getCreditAccount();
    }
    return null;
  }


  /**
  @param {Account|string} account The account object, id or name
  @returns {Account} The account name at the other side of the transaction given one side.
  */
  Transaction.prototype.getOtherAccountName = function(account) {
    var otherAccount = this.getOtherAccount(account);
    if (otherAccount != null) {
      return otherAccount.getName();
    } else {
      return "";
    }
  }

  Transaction.prototype.getAccount_ = function(account) {
    if (account == null || account.getId) {
      return account;
    }
    return this.book.getAccount(account);
  }

  Transaction.prototype.isCreditOnTransaction_ = function(account) {
    return this.getCreditAccount() != null &amp;&amp; account != null &amp;&amp; this.getCreditAccount().getId() == account.getId();
  }

  Transaction.prototype.isDebitOnTransaction_ = function(account) {
    return this.getDebitAccount() != null &amp;&amp; account != null &amp;&amp; this.getDebitAccount().getId() == account.getId();
  }




  //DESCRIPTION
  /**
  @returns {string} The description of this transaction
  @see {Transaction#setDescription}
  */
  Transaction.prototype.getDescription = function() {
    if (this.wrapped.description == null) {
      return "";
    }
    return this.wrapped.description;
  }



  //INFORMED DATE
  /**
  @returns {Date} The date the user informed for this transaction, adjusted to book's time zone
  */
  Transaction.prototype.getInformedDate = function() {
    if (this.informedDate == null) {
      this.informedDate = Utils_.convertValueToDate(this.getInformedDateValue(), this.book.getTimeZoneOffset());
    }
    return this.informedDate;
  }


  /**
  @returns {number} The date the user informed for this transaction. The number format is YYYYMMDD
  */
  Transaction.prototype.getInformedDateValue = function() {
      return this.informedDateValue;
  }

  /**
  @returns {string} The date the user informed for this transaction, formatted according to {@link Book#getDatePattern|date pattern of book}
  */
  Transaction.prototype.getInformedDateText = function() {
      return this.informedDateText;
  }

  //POST DATE
  /**
  @returns {Date} The date time user has recorded/posted this transaction
  */
  Transaction.prototype.getPostDate = function() {
    return this.postDate;
  }
  
  /**
  @returns {string} The date time user has recorded/posted this transaction, formatted according to {@link Book#getDatePattern|date pattern of book}
  */
  Transaction.prototype.getPostDateText = function() {
    return Utilities.formatDate(this.getPostDate(), this.book.getLocale(), this.book.getDatePattern() + " HH:mm:ss")
    return this.informedDateText;
  }  


  //EVOLVED BALANCES
  /**
  @private
  */
  Transaction.prototype.getCaEvolvedBalance_ = function() {
    return this.wrapped.caBal;
  }

  /**
  @private
  */
  Transaction.prototype.getDaEvolvedBalance_ = function() {
    return this.wrapped.daBal;
  }

  /**
  Gets the balance that the {@link Account} has at that {@link Transaction#getInformedDate|informed date}, when listing transactions of that {@link Account}.
  &lt;br/>&lt;br/>
  Evolved balances is returned when {@link Book#search|searching for transactions} of a permanent {@link Account}.
  &lt;br/>&lt;br/>
  Only comes with the last posted transaction of the day.

  @param {boolean} [strict] True to strict get the balance, no matter the {@link Account#isCredit|credit nature} of this Account.

  @see {@link Account#isCredit}
  @see {@link Account#isPermanent}
  @see {@link Book#search}
  @see {@link Transaction#getInformedDate}
  */
  Transaction.prototype.getAccountBalance = function(strict) {
    var accountBalance = this.getCaEvolvedBalance_();
    var isCa = true;
    if (accountBalance == null) {
      accountBalance = this.getDaEvolvedBalance_();
      isCa = false;
    }
    if (accountBalance != null) {
      if (!strict) {
        var account = isCa ? this.getCreditAccount() : this.getDebitAccount();
        accountBalance = Utils_.getRepresentativeValue(accountBalance, account.isCredit());
      }
      return Utils_.round(accountBalance);
    } else {
      return null;
    }
  }


  Transaction.prototype.configure_ = function() {
    var creditAccount = this.book.getAccount(this.wrapped.creditAccId);
    var debitAccount = this.book.getAccount(this.wrapped.debitAccId);
    this.creditAccount = creditAccount;
    this.debitAccount = debitAccount;
    this.informedDateValue = this.wrapped.informedDateValue;
    this.informedDateText = this.wrapped.informedDateText;
    this.postDate = new Date(new Number(this.wrapped.postDateMs));

    if (this.isPosted()) {
      this.alreadyPosted = true;
    } else {
      this.alreadyPosted = false;
    }
  }

}</code></pre>
        </article>
    </section>




                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Tue Aug 13 2019 12:03:50 GMT-0300 (Brasilia Standard Time)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers</a>
        </p>
    </div>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
